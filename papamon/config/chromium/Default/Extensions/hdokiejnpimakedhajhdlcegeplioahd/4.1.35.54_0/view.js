VaultItemBaseDisplay=function(g){this._model=g;this._parent=null;this._contextMenuHandler=this.createContextMenuHandler();this._eventHandler=LPTools.createEventHandler(this);this._selected=!1;this._$_element=this._element=null;this._textElements=[];this._destructed=!1;this._shown=!0;this._isLocked=!1};VaultItemDisplay=function(g){VaultItemBaseDisplay.call(this,g);this._dragStartSelected=!1};VaultItemDisplay.prototype=Object.create(VaultItemBaseDisplay.prototype);
VaultItemDisplay.prototype.constructor=VaultItemDisplay;AccountBaseDisplay=function(g){VaultItemDisplay.call(this,g)};AccountBaseDisplay.prototype=Object.create(VaultItemDisplay.prototype);AccountBaseDisplay.prototype.constructor=AccountBaseDisplay;AccountDisplay=function(g){AccountBaseDisplay.call(this,g)};AccountDisplay.prototype=Object.create(AccountBaseDisplay.prototype);AccountDisplay.prototype.constructor=AccountDisplay;ApplicationDisplay=function(g){VaultItemDisplay.call(this,g)};
ApplicationDisplay.prototype=Object.create(VaultItemDisplay.prototype);ApplicationDisplay.prototype.constructor=ApplicationDisplay;NoteDisplay=function(g){AccountBaseDisplay.call(this,g)};NoteDisplay.prototype=Object.create(AccountBaseDisplay.prototype);NoteDisplay.prototype.constructor=NoteDisplay;AttachmentDisplay=function(g){VaultItemBaseDisplay.call(this,g)};AttachmentDisplay.prototype=Object.create(VaultItemBaseDisplay.prototype);AttachmentDisplay.prototype.constructor=AttachmentDisplay;
FormFillDisplay=function(g){VaultItemDisplay.call(this,g)};FormFillDisplay.prototype=Object.create(VaultItemDisplay.prototype);FormFillDisplay.prototype.constructor=FormFillDisplay;IdentityDisplay=function(g){VaultItemBaseDisplay.call(this,g)};IdentityDisplay.prototype=Object.create(VaultItemBaseDisplay.prototype);IdentityDisplay.prototype.constructor=IdentityDisplay;AllIdentityDisplay=function(g){IdentityDisplay.call(this,g)};AllIdentityDisplay.prototype=Object.create(IdentityDisplay.prototype);
AllIdentityDisplay.prototype.constructor=AllIdentityDisplay;
GroupDisplay=function(g,l){VaultItemBaseDisplay.call(this,g);this._itemCount=0;this._items=[];this._subGroups=[];if(l)for(var e=0,m=l.length;e<m;++e){var p=l[e];p instanceof GroupDisplay?(this._subGroups.push(p),this._itemCount+=p._itemCount):(this._items.push(p),++this._itemCount);p.setParent(this)}this._model&&(this._contextMenuElement=LPTools.createElement("li",{vaultAction:Constants.ACTION_MOVE_TO_FOLDER},this._model.getName()));this._dragTarget=!0;this._openTimeouts=[];this._filteredSubGroups=
this._filteredItems=this._filter=this._subFolderContents=this._itemContents=null;this._expanded=!0};GroupDisplay.prototype=Object.create(VaultItemBaseDisplay.prototype);GroupDisplay.prototype.constructor=GroupDisplay;SharedGroupDisplay=function(g,l){GroupDisplay.call(this,g,l)};SharedGroupDisplay.prototype=Object.create(GroupDisplay.prototype);SharedGroupDisplay.prototype.constructor=SharedGroupDisplay;LinkedGroupDisplay=function(g,l){SharedGroupDisplay.call(this,g,l)};
LinkedGroupDisplay.prototype=Object.create(SharedGroupDisplay.prototype);LinkedGroupDisplay.prototype.constructor=LinkedGroupDisplay;EmergencyAccessGroupDisplay=function(g,l){LinkedGroupDisplay.call(this,g,l)};EmergencyAccessGroupDisplay.prototype=Object.create(LinkedGroupDisplay.prototype);EmergencyAccessGroupDisplay.prototype.constructor=EmergencyAccessGroupDisplay;
Container=function(g,l){GroupDisplay.call(this,null,g);this._selectedItems=[];this._lastToggleSelectTarget=null;this._buildOptions=l||{};this._buildOptions.sortFunction=this._buildOptions.sortFunction||this.sortByNameAsc;this.parseExcludeActions();this._lastSearchTerm=null;this._folderView=!0;this._sortedFilteredItems=this._sortedItems=null;this._subscriptions=[];(function(e){e.subscribe(Topics.COLLAPSE_ALL,function(){e.collapseAll();e._buildOptions.folderStateChange&&e._buildOptions.folderStateChange(e)});
e.subscribe(Topics.EXPAND_ALL,function(){e.expandAll();e._buildOptions.folderStateChange&&e._buildOptions.folderStateChange(e)});e.subscribe(Topics.DISPLAY_COMPACT,function(){e.displayCompact()});e.subscribe(Topics.DISPLAY_LARGE,function(){e.displayLarge()});e.subscribe(Topics.CLEAR_DATA,function(){e.destruct()})})(this);if(this.separateFavorites()){this.favoritesGroup=new FavoritesGroup;this.favoritesGroup.setParent(this);this.favoritesGroup._buildOptions={excludeActions:[Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU,
Constants.ACTION_OPEN_MOVE_TO_SUB_FOLDER_MENU],allowDrag:!1};this.favoritesGroup.parseExcludeActions();for(var e=this.getItemModelChildren(),m=0,p=e.length;m<p;++m){var c=e[m];c.isFavorite()&&this.addFavorite(c)}}(function(e,b){e&&(b.searchInput=$("#"+e),b.searchInput.LP_addSearchHandlers("inputDialog",function(a){b.applySearch(a)}),b._buildOptions.keyboardNavigation&&b.searchInput.bind("keydown.containerSearchNav",function(a){if(40===(a.keyCode||a.which)){var d=b.getAllChildrenOrdered();0<d.length&&
(d[0].focus(),a.preventDefault(),a.stopPropagation())}}))})(LPTools.getOption(l,"searchInput",null),this)};Container.prototype=Object.create(GroupDisplay.prototype);Container.prototype.constructor=Container;Container.prototype.separateFavorites=function(){return LPTools.getOption(this._buildOptions,"separateFavorites",!1)};Container.prototype.subscribe=function(g,l){var e=Topics.get(g);this._subscriptions.push({topic:e,callback:l});e.subscribe(l)};
Container.prototype.addFavorite=function(g){if(this.favoritesGroup){for(var l=this.favoritesGroup.getItemModelChildren(),e=0,m=l.length;e<m;++e)if(l[e]===g)return;this.favoritesGroup.addChild(g.newDisplayObject())}};GridListContainer=function(g,l){Container.call(this,g,l);(function(e){e.subscribe(Topics.DISPLAY_GRID,function(){e.displayAsGrid()});e.subscribe(Topics.DISPLAY_LIST,function(){e.displayAsList()})})(this)};GridListContainer.prototype=Object.create(Container.prototype);
GridListContainer.prototype.constructor=GridListContainer;IdentityContainer=function(g,l){Container.call(this,g,l)};IdentityContainer.prototype=Object.create(Container.prototype);IdentityContainer.prototype.constructor=IdentityContainer;
(function(){IdentityContainer.prototype.sortByNameAsc=function(g,l){return g instanceof AllIdentityDisplay?-1:l instanceof AllIdentityDisplay?1:(0,VaultItemBaseDisplay.prototype.sortByNameAsc)(g,l)};IdentityContainer.prototype.sortByNameDesc=function(g,l){return g instanceof AllIdentityDisplay?-1:l instanceof AllIdentityDisplay?1:(0,VaultItemBaseDisplay.prototype.sortByNameDesc)(g,l)}})();DummyGroupDisplay=function(g,l){GroupDisplay.call(this,g,l)};DummyGroupDisplay.prototype=Object.create(GroupDisplay.prototype);
DummyGroupDisplay.prototype.constructor=DummyGroupDisplay;DummyGroupDisplay.prototype.removeChild=function(){GroupDisplay.prototype.removeChild.apply(this,arguments);if(this.isEmpty()){for(var g=this;g._parent&&g._parent instanceof DummyGroupDisplay&&g._parent.isEmpty();)g=g._parent;g.destruct()}};DefaultGroupDisplay=function(g,l){GroupDisplay.call(this,g,l)};DefaultGroupDisplay.prototype=Object.create(GroupDisplay.prototype);DefaultGroupDisplay.prototype.constructor=DefaultGroupDisplay;
DefaultGroupDisplay.prototype.getContextMenuItems=function(){return[new LPTools.ContextMenuItem(Constants.ACTION_OPEN_ALL)]};DefaultGroupDisplay.prototype.addChild=function(){var g=this.isEmpty();GroupDisplay.prototype.addChild.apply(this,arguments);g&&this.show()};DefaultGroupDisplay.prototype.removeChild=function(){GroupDisplay.prototype.removeChild.apply(this,arguments);this.isEmpty()&&this.hide()};
FavoritesGroup=function(g){DefaultGroupDisplay.call(this,new DummyGroup(Strings.translateString("Favoritesproper")),g)};FavoritesGroup.prototype=Object.create(DefaultGroupDisplay.prototype);FavoritesGroup.prototype.constructor=FavoritesGroup;ChangePasswordSite=function(g){VaultItemBaseDisplay.call(this,g)};ChangePasswordSite.prototype=Object.create(VaultItemBaseDisplay.prototype);ChangePasswordSite.prototype.constructor=ChangePasswordSite;
ChangePasswordSite.prototype.build=function(g){g=LPTools.buildCheckbox({vaultaction:Constants.ACTION_TOGGLE_SELECT},{text:this.getDisplayName()+": "+this._model.getUsername(),addClickHandler:!1});g.setAttribute("class","checkboxContainer");return g};SharedFolderAccessCheckbox=function(g){VaultItemBaseDisplay.call(this,g)};SharedFolderAccessCheckbox.prototype=Object.create(VaultItemBaseDisplay.prototype);SharedFolderAccessCheckbox.prototype.constructor=SharedFolderAccessCheckbox;
SharedFolderAccessCheckbox.prototype.build=function(g){g=LPTools.buildCheckbox({vaultaction:Constants.ACTION_TOGGLE_SELECT},{text:this.getDisplayName(),addClickHandler:!1});g.setAttribute("class","checkboxContainer");return g};
(function(g,l,e,m){var p=function(e){for(var c=[],b={},a=0,d=e.length;a<d;++a){var h=e[a]._model,k=h.getID();if(void 0===b[k])c.push(h),b[k]=h;else{for(var k=!0,t=0,u=c.length;t<u;++t)if(h===c[t]){k=!1;break}k&&c.push(h)}}return c};(function(){VaultItemBaseDisplay.prototype.DISPLAY_GRID="tile";VaultItemBaseDisplay.prototype.DISPLAY_LIST="list";VaultItemBaseDisplay.prototype.DISPLAY_OPTIONS={COMPACT:!1};VaultItemBaseDisplay.prototype.COMPACT_CLASS="compact";Topics.get(Topics.DISPLAY_COMPACT).subscribe(function(){VaultItemBaseDisplay.prototype.DISPLAY_OPTIONS.COMPACT=
!0});Topics.get(Topics.DISPLAY_LARGE).subscribe(function(){VaultItemBaseDisplay.prototype.DISPLAY_OPTIONS.COMPACT=!1});VaultItemBaseDisplay.prototype.lockForUpdate=function(){this._isLocked||(this._$_element&&(this.deselect(),this._$_element.addClass("locked"),this._$_element.attr("draggable","false"),this._lockedOverlay||(this._lockedOverlay=e.createElement("div","itemLocked")),this._element.appendChild(this._lockedOverlay)),this._isLocked=!0)};VaultItemBaseDisplay.prototype.unlock=function(){this._isLocked&&
(this._$_element&&(this._$_element.removeClass("locked"),this._$_element.attr("draggable",this.isDraggable().toString()),this._element.removeChild(this._lockedOverlay)),this._isLocked=!1)};VaultItemBaseDisplay.prototype.isDeleted=function(){return!1};VaultItemBaseDisplay.prototype.getElement=function(){return this._$_element};VaultItemBaseDisplay.prototype.getContextMenuItems=function(b){return[]};VaultItemBaseDisplay.prototype.createContextMenuHandler=function(b){return function(a){b?(b.action="sitepassword",
b.source="vault"):b={action:"sitepassword",source:"vault"};return function(d){Topics.get(Topics.CONTEXT_CLOSE).publish();a.handleEvent(d,b)}}(this)};VaultItemBaseDisplay.prototype.handleContextMenu=function(b){var a=this.createContextMenu();Topics.get(Topics.CONTEXT_MENU).publish(b,a)};VaultItemBaseDisplay.prototype.createContextMenu=function(){var b=this.getItemsForAction(),a=this._selected&&1<this.getSelectedItems().length,a=this.isDeleted()||this._model.isDeleted()?this.getDeletedContextMenuItems(a):
this.getContextMenuItems(a),d=l.getElementById("contextMenu"),h=d.children[0];g(h).empty();for(var k={},c=0,f=a.length;c<f;++c){var q=a[c],r=q.getAction();if(!0!==k[r])for(var n=0,m=b.length;n<m;++n)if(b[n].isExcludedAction(r)){k[r]=!0;break}!0!==k[r]&&q.build(h,this._contextMenuHandler,this._eventHandler)}e.addKeyBoardNavigation(h.children);return d};VaultItemBaseDisplay.prototype.getDeletedContextMenuItems=function(b){b=[];b.push(new e.ContextMenuItem(Constants.ACTION_RESTORE));b.push(new e.ContextMenuItem(Constants.ACTION_PURGE));
return b};VaultItemBaseDisplay.prototype.isExcludedAction=function(b,a){a=a||this.getBuildOptions();var d=e.getOption(a,"excludeActions",{})[b];void 0===d&&(d=!1);return d};VaultItemBaseDisplay.prototype.getDeletedItemButtonActions=function(){return[Constants.ACTION_RESTORE,Constants.ACTION_PURGE]};VaultItemBaseDisplay.prototype.getItemButtonActions=function(){return[]};VaultItemBaseDisplay.prototype.handleEvent=function(b,a){try{switch(b.type){default:if(!this._isLocked){var d=this.getVaultAction(b.target);
d&&this.handleClickEvent(d,g.extend({shiftKey:b.shiftKey,allowMultiple:e.getAttribute(this._element,b.target,"allowMultiple")||!0,target:b.target},a))}b.preventDefault();b.stopPropagation();break;case "contextmenu":this._isLocked||this.handleContextMenu(b);this._element.blur();b.preventDefault();b.stopPropagation();break;case "dragenter":this.handleDragEnter(b);break;case "dragleave":this.handleDragLeave(b);break;case "dragover":this.handleDragOver(b);break;case "drop":this.handleDrop(b);break;case "dragstart":this.handleDragStart(b);
break;case "dragend":this.handleDragEnd(b);break;case "keydown":this.handleKeyDown(b);break;case "focusin":this.handleFocusIn(b);break;case "focusout":this.handleFocusOut(b)}}catch(h){LPPlatform.logException(h)}};VaultItemBaseDisplay.prototype.getVaultAction=function(b){return e.getAttribute(this._element,b,"vaultaction")};VaultItemBaseDisplay.prototype.isOverride=function(){return!1};VaultItemBaseDisplay.prototype.handleClickEvent=function(b,a){if(this.isOverride(b)&&"function"===typeof this[b])this[b]();
else switch(b){case Constants.ACTION_TOGGLE_SELECT:this.handleToggleSelectedEvent(a.shiftKey);break;case Constants.ACTION_OPEN_MORE_OPTIONS:this.openMoreOptions();break;case Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU:this.openMoveToFolderMenu(a.target,this.getOtherGroups(!0));break;case Constants.ACTION_EDIT:a.dialogActions=this.getDialogActions();default:a.itemsForAction=this.getModelItemsForAction(b,a),this._model.handleClickEvent(b,a)}};VaultItemBaseDisplay.prototype.getDialogActions=function(){for(var b=
[],a=this.getItemButtonActions(),d=0,h=a.length;d<h;++d)this.isExcludedAction(a[d])||b.push(a[d]);return b};VaultItemBaseDisplay.prototype.handleEnter=function(b){b.target===this._element&&(b=this.getLaunchElementAction())&&this.handleClickEvent(b,{})};VaultItemBaseDisplay.prototype.handleFocusIn=function(){this._focused=!0;this._$_element.addClass("focus")};var c=null;Topics.get(Topics.DIALOG_OPEN).subscribe(function(){clearTimeout(c)});VaultItemBaseDisplay.prototype.handleFocusOut=function(){this._focused=
!1;(function(b){c=setTimeout(function(){!b._focused&&b._$_element&&b._$_element.removeClass("focus")},50)})(this)};VaultItemBaseDisplay.prototype.focus=function(){this._element.focus()};VaultItemBaseDisplay.prototype.handleKeyDown=function(b,a){switch(b.keyCode||b.which){case 13:this.handleEnter(b);break;case 37:this.navigateBackward();break;case 38:this.navigateUp();break;case 39:this.navigateForward();break;case 40:this.navigateDown()}};VaultItemBaseDisplay.prototype.navigateForward=function(){this.navigate(1)};
VaultItemBaseDisplay.prototype.navigateBackward=function(){this.navigate(-1)};VaultItemBaseDisplay.prototype.navigateUp=function(){this.navigateVerticalTile(-1)};VaultItemBaseDisplay.prototype.navigate=function(b){var a=this.getContainer();if(a)for(var a=a.getAllChildrenOrdered(),d=0,h=a.length;d<h;++d)if(a[d]===this){var k=d+b;0>k?k=0:k>h-1&&(k=h-1);a[k].focus()}};VaultItemBaseDisplay.prototype.navigateVerticalTile=function(){return function(b){var a=this.getContainer();if(a){for(var d=-1,a=a.getAllChildrenOrdered(),
h=a.length,k=0;k<h;++k)if(a[k]===this){d=k;break}for(var k=this._$_element.offset(),e=k.top;-1<d+b&&d+b<h;){var d=d+b,c=a[d]._$_element.offset();if(0<b&&c.top>e||0>b&&c.top<e){e=c.top;break}}if(!(a[d]instanceof GroupDisplay))for(;-1<d+b&&d+b<h;){var c=b,f=k,g=e,n=a[d+b]._$_element.offset(),c=0<c&&n.top>g||0>c&&n.top<g?!0:0<c&&n.left>f.left||0>c&&n.left<f.left?!0:!1;if(c)break;else d+=b}a[d].focus()}}}();VaultItemBaseDisplay.prototype.navigateDown=function(){this.navigateVerticalTile(1)};VaultItemBaseDisplay.prototype.getModelItemsForAction=
function(b,a){return p(this.getItemsForAction(a))};VaultItemBaseDisplay.prototype.deselect=function(b){if(this._selected){this._selected=!1;this._$_element.removeClass("selected");var a=this.getContainer();a&&a.removeSelectedItem(this,b)}};VaultItemBaseDisplay.prototype.select=function(b){if(!this._selected&&this._shown){this._selected=!0;this._$_element.addClass("selected");var a=this.getContainer();a&&a.addSelectedItems(this,b)}};VaultItemBaseDisplay.prototype.handleToggleSelectedEvent=function(b){this._selected?
this.deselect(b):this.select(b);if(b=this.getContainer())b._lastToggleSelectTarget=this};VaultItemBaseDisplay.prototype.getItemsForAction=function(b){var a=[this];!this._selected||b&&!b.allowMultiple||(a=this.getSelectedItems());return a};VaultItemBaseDisplay.prototype.sortByNameAsc=function(b,a){return VaultItemBase.prototype.sortByTextFunction(b,a,"getDisplayName",!0)};VaultItemBaseDisplay.prototype.sortByNameDesc=function(b,a){return VaultItemBase.prototype.sortByTextFunction(b,a,"getDisplayName",
!1)};VaultItemBaseDisplay.prototype.sortByMostRecent=function(b,a){return VaultItemBase.prototype.sortByFunction(b,a,"getLastTouchValue",!1)};VaultItemBaseDisplay.prototype.getLastTouchValue=function(){return this._model.getLastTouch()};VaultItemBaseDisplay.prototype.getSearchResultItems=function(b,a){return 0<b.length&&!this.matches(b,a)?null:this};VaultItemBaseDisplay.prototype.applySearch=function(b,a){var d=this.matches(b,a);if(0<b.length&&!d)return null!==d&&this.hide(),null;this.show();this.expandParents(!1);
return 1};VaultItemBaseDisplay.prototype.expandParents=function(){for(var b=this._parent;b;)b.expand(),b=b._parent};VaultItemBaseDisplay.prototype.matches=function(b,a){if(0===b.length)return!0;var d=this._model.getSearchTokens(a);if(d){for(var h=0;h<b.length;++h){for(var k=b[h].toLowerCase(),c=!1,f=0,g=d.length;f<g;++f)if(-1<d[f].toLowerCase().indexOf(k)){c=!0;e.getOption(a,"removeMatchingTerms",!1)&&(b.splice(h,1),--h);break}if(!c)return!1}return!0}return null};VaultItemBaseDisplay.prototype.addViewToModel=
function(){this._model&&this._model.addView(this)};VaultItemBaseDisplay.prototype.removeViewFromModel=function(){this._model&&this._model.removeView(this)};VaultItemBaseDisplay.prototype.createTextElement=function(b,a,d){b=e.createElement(b,d);d=l.createTextNode(a.apply(this));b.appendChild(d);this._textElements.push({element:d,data:a});return b};VaultItemBaseDisplay.prototype.setElement=function(b){b?(this._element=b,this._$_element=g(b)):this._$_element=this._element=null};VaultItemBaseDisplay.prototype.getScrollTop=
function(){var b=this._element.offsetTop,a=this.getContainer(),d=this._parent!==a?this._parent.getLevel()+1:0;0<d&&a&&a.usesStickyFolders()&&(b-=this._parent._$_element.find(".folderContainer").outerHeight(!0)*d);return b};VaultItemBaseDisplay.prototype.updateTextElements=function(){if(this._textElements)for(var b=0,a=this._textElements.length;b<a;++b){var d=this._textElements[b];d.element.textContent=d.data.apply(this)}};VaultItemBaseDisplay.prototype.updateView=function(b,a){this.updateTextElements();
this.setAccesibilityAttributes();var d=this.getContainer();if(this._parent instanceof FavoritesGroup)this._model.isFavorite()||this._parent.removeChild(this);else if(d){if((this._parent?this._parent._model:null)!==b&&d.displayItemsInSpecifiedGroup()){var h=d;b&&((h=d.getGroupDisplay(b))||(h=d.addDummyGroups(b)));this._parent.removeChild(this);h.addChild(this,a)}this._model.isFavorite()&&d.addFavorite(this._model)}};VaultItemBaseDisplay.prototype.reattachElement=function(){this._parent._itemContents.appendChild(this._element)};
VaultItemBaseDisplay.prototype.addClass=function(b){e.addClass(this._element,b)};VaultItemBaseDisplay.prototype.setParent=function(b){this._parent=b};VaultItemBaseDisplay.prototype.show=function(){null!==this._element&&(this._$_element.LP_show(),null===this._element.parentElement&&this.reattachElement(),this._shown=!0)};VaultItemBaseDisplay.prototype.hide=function(){null!==this._$_element&&(this._$_element.LP_hide(),this.deselect(),this._shown=!1)};var f=function(b,a){if(null!==b){var d=b.getAttribute("class").split(" ");
d[0]=a;b.setAttribute("class",d.join(" "))}};VaultItemBaseDisplay.prototype.displayAsList=function(){f(this._element,VaultItemBaseDisplay.prototype.DISPLAY_LIST)};VaultItemBaseDisplay.prototype.displayAsGrid=function(){f(this._element,VaultItemBaseDisplay.prototype.DISPLAY_GRID)};VaultItemBaseDisplay.prototype.setupListeners=function(b,a){b.bind("click",this._eventHandler);b.bind("contextmenu",this._eventHandler);a.keyboardNavigation&&(b.bind("keydown",this._eventHandler),b.bind("focusin",this._eventHandler),
b.bind("focusout",this._eventHandler))};VaultItemBaseDisplay.prototype.shouldDragAndDrop=function(b){var a=e.getOption(b,"allowDrag",!0);return e.getOption(b,"forceDrag",!1)||a&&this.isDraggable()};VaultItemBaseDisplay.prototype.build=function(b){var a=b.display||this.getItemClass();this.DISPLAY_OPTIONS.COMPACT&&(a+=" "+this.COMPACT_CLASS);a={"class":a,vaultaction:Constants.ACTION_TOGGLE_SELECT,draggable:this.shouldDragAndDrop(b).toString()};b.keyboardNavigation&&(a.tabindex="0");a=e.createElement("div",
a);b.additionalItemClasses&&e.addClass(a,b.additionalItemClasses);b.minimized&&e.addClass(a,"minimized");var d=e.createElement("div",{"class":"itemWrapper"});a.appendChild(d);var h=e.createElement("div","listCheckboxContainer");d.appendChild(h);(h=this.buildItemIconElement(b))?d.appendChild(h):e.addClass(a,"noIcon");h=e.createElement("div","itemInfo");d.appendChild(h);d=e.createElement("div","itemInfoTable");h.appendChild(d);for(var k=this.buildItemInfoTextElements(b),h=0,c=k.length;h<c;++h){var f=
k[h];0===h?1<c&&e.addClass(f,"first"):e.addClass(f,"showLarge");d.appendChild(f)}b=this.buildItemButtons(b);h=0;for(c=b.length;h<c;++h)k=e.createElement("div","itemButtonCell"),k.appendChild(b[h]),d.appendChild(k);return a};VaultItemBaseDisplay.prototype.setAccesibilityAttributes=function(){this._element&&this._element.setAttribute("aria-label",this._model.toString())};VaultItemBaseDisplay.prototype.buildItemHoverInfo=function(){return null};VaultItemBaseDisplay.prototype.buildItemButtons=function(b){for(var a=
[],d=this._model.isDeleted()?this.getDeletedItemButtonActions():this.getItemButtonActions(),h=0;h<d.length;++h){var k=d[h];this.isExcludedAction(k,b)||a.push(e.buildItemButton(k))}return a};VaultItemBaseDisplay.prototype.rebuild=function(){if(this._element&&this._element.parentElement){var b=this.getBuildOptions(),a=this.build(b);this._element.parentElement.insertBefore(a,this._element);this._$_element.remove();this.postBuild(a,b);return!0}return!1};VaultItemBaseDisplay.prototype.getLaunchElementAction=
function(){return null};VaultItemBaseDisplay.prototype.preBuild=function(b){b=e.getOption(b,"override",null);"function"===typeof b&&(b=b.apply(this),g.extend(this,b))};VaultItemBaseDisplay.prototype.postBuild=function(b,a){a=a||{};this.setElement(b);this.setupListeners(this._$_element,a);this.addViewToModel();this.setAccesibilityAttributes()};VaultItemBaseDisplay.prototype.buildItemIconElement=function(){var b=e.createElement("div","itemIcon"),a=this.getIconElement();b.appendChild(a);a.setAttribute("aria-hidden",
"true");a.setAttribute("role","presentation");a=e.createElement("div","itemIconOverlay");b.appendChild(a);var d=this._model.isDeleted()?null:this.getLaunchElementAction();null===d||this.isExcludedAction(d)||(d=e.createElement("button",{"class":"launchButton",vaultaction:d},Strings.Vault[Constants.ACTION_BUTTONS[d].title]),a.appendChild(d));d=e.createElement("button","itemCheckbox");a.appendChild(d);return b};VaultItemBaseDisplay.prototype.buildItemInfoTextElement=function(){return function(b){for(var a=
e.createElement("div","itemInfoText"),d=0,h=b.length;d<h;++d){var k=b[d];if(k instanceof Array){var c=null;if(0<k.length)for(var c=e.createElement("div"),f=0,g=k.length;f<g;++f)c.appendChild(k[f]);k=c}k&&a.appendChild(k)}return a}}();VaultItemBaseDisplay.prototype.getDisplayName=function(){return this._model.getName()};VaultItemBaseDisplay.prototype.createSecondaryNameTextElement=function(){return null};VaultItemBaseDisplay.prototype.buildItemInfoTextElements=function(){return[this.buildItemInfoTextElement([this.createTextElement("p",
this.getDisplayName,"name"),this.createSecondaryNameTextElement()])]};VaultItemBaseDisplay.prototype.getItemClass=function(){return VaultItemBaseDisplay.prototype.DISPLAY_LIST};VaultItemBaseDisplay.prototype.isDraggable=function(){return!1};VaultItemBaseDisplay.prototype.getIconElement=function(){return null};VaultItemBaseDisplay.prototype.destruct=function(){if(!this._destructed){this._parent&&(this.deselect(),this._parent.removeChild(this),this._$_element&&this._$_element.remove());this.removeViewFromModel();
for(var b in this)this.hasOwnProperty(b)&&delete this[b];this._destructed=!0}};VaultItemBaseDisplay.prototype.showAllChildren=function(){this.show();return 1};VaultItemBaseDisplay.prototype.applyFilter=function(b){if(void 0===b.func||b.func(this))return this.show(),1;this.hide();return 0};VaultItemBaseDisplay.prototype.collapseAll=function(){};VaultItemBaseDisplay.prototype.expandAll=function(){};VaultItemBaseDisplay.prototype.displayCompact=function(){this._$_element&&this._$_element.addClass(this.COMPACT_CLASS)};
VaultItemBaseDisplay.prototype.displayLarge=function(){this._$_element&&this._$_element.removeClass(this.COMPACT_CLASS)};VaultItemBaseDisplay.prototype.openMoreOptions=function(){};VaultItemBaseDisplay.prototype.addFavorite=function(){};VaultItemBaseDisplay.prototype.getContainer=function(){for(var b=this;b._parent;)b=b._parent;return b instanceof Container?b:null};VaultItemBaseDisplay.prototype.getBuildOptions=function(){for(var b=[],a=this;a;)a._buildOptions&&b.unshift(a._buildOptions),a=a._parent;
b.unshift({});return g.extend.apply(window,b)};VaultItemBaseDisplay.prototype.getSelectedItems=function(){var b=[],a=this.getContainer();a&&(b=a.getSelectedItems());return b};VaultItemBaseDisplay.prototype.usesStickyFolders=function(){var b=!1,a=this.getContainer();a&&(b=a.usesStickyFolders());return b};VaultItemBaseDisplay.prototype.openMoveToFolderMenu=function(b,a){var d=g(b).closest(".subMenuOption").find(".subMenu");if(0===d.children().length){a.sort(VaultItemBaseDisplay.prototype.sortByNameAsc);
for(var h=0,k=a.length;h<k;++h){var c=a[h],f=g(c._contextMenuElement);f.unbind("click");f.bind("click",this.createContextMenuHandler({group:c._model,scrollIntoView:!1}));d.append(f)}}d.show("fast");e.addKeyBoardNavigation(d.children());e.setNavIndex(0)};VaultItemBaseDisplay.prototype.getOtherGroups=function(b){var a=[],d=this.getContainer(),h=this._parent===d?this:this._parent;if(d){d=d.getAllSubGroups(b);b=h.getAllSubGroups(b);for(var k=0,c=d.length;k<c;++k)d[k]!==h&&(0<b.length&&b[0]===d[k]?k+=
b.length-1:a.push(d[k]))}return a}})();(function(){var c=VaultItemBaseDisplay.prototype.DISPLAY_GRID;Topics.get(Topics.DISPLAY_GRID).subscribe(function(){c=VaultItemBaseDisplay.prototype.DISPLAY_GRID});Topics.get(Topics.DISPLAY_LIST).subscribe(function(){c=VaultItemBaseDisplay.prototype.DISPLAY_LIST});var f=l.getElementById("dragElement");null===f&&(f=e.createElement("div",{id:"dragElement"}),l.body.appendChild(f));VaultItemDisplay.prototype.navigateDown=function(){this.getItemClass()===this.DISPLAY_LIST?
this.navigateForward():VaultItemBaseDisplay.prototype.navigateDown.apply(this,arguments)};VaultItemDisplay.prototype.navigateUp=function(){this.getItemClass()===this.DISPLAY_LIST?this.navigateBackward():VaultItemBaseDisplay.prototype.navigateUp.apply(this,arguments)};VaultItemDisplay.prototype.handleClickEvent=function(b,a){switch(b){case Constants.ACTION_OPEN_MOVE_TO_SUB_FOLDER_MENU:this.openMoveToFolderMenu(a.target,this.getAllSubGroups(!0));break;default:VaultItemBaseDisplay.prototype.handleClickEvent.apply(this,
arguments)}};VaultItemDisplay.prototype.getItemClass=function(){return c};VaultItemDisplay.prototype.getAllSubGroups=function(){return this._parent.getAllSubGroups()};VaultItemDisplay.prototype.setupListeners=function(b,a){VaultItemBaseDisplay.prototype.setupListeners.apply(this,arguments);this.shouldDragAndDrop(a)&&(b=b.get(0),LPPlatform.addEventListener(b,"dragstart",this._eventHandler),LPPlatform.addEventListener(b,"dragend",this._eventHandler),a&&"function"===typeof a.dragstart&&LPPlatform.addEventListener(b,
"dragstart",a.dragstart))};VaultItemDisplay.prototype.destruct=function(){if(!this._destructed){if(this._element){LPPlatform.removeEventListener(this._element,"dragstart",this._eventHandler);LPPlatform.removeEventListener(this._element,"dragend",this._eventHandler);var b=this.getContainer();b&&"function"===typeof b._buildOptions.dragstart&&LPPlatform.removeEventListener(this._element,"dragend",b._buildOptions.dragstart)}VaultItemBaseDisplay.prototype.destruct.apply(this,arguments)}};VaultItemDisplay.prototype.isDraggable=
function(){return!0};VaultItemDisplay.prototype.getScrollTop=function(){var b=VaultItemBaseDisplay.prototype.getScrollTop.apply(this,arguments);return b-=parseInt(this._$_element.css("margin-top"))};VaultItemDisplay.prototype.handleDragStart=function(b){var a="function"===typeof b.dataTransfer.setDragImage;e.removeDOMChildren(f);var d=this.getItemsForAction();e.setDragItems(d);for(var h=[],k={},c=0,g=d.length,q=0;c<g;++c){var l=d[c];l._parent.setDragTarget(!1);if(a){if(5>q){var n=l._model,m=n.getID(),
p=!0;if(void 0===k[m])h.push(n),k[m]=n;else for(var m=0,v=h.length;m<v;++m)if(n===h[m]){p=!1;break}p&&(f.appendChild(l.buildDragElement(q===g-1)),++q)}else 5===q&&f.appendChild(e.createElement("div","dragItem last","... +"+(g-c)+" more"));l._$_element.addClass("dragStarted")}}a&&(b.dataTransfer.setDragImage(f,-20,0),b.dataTransfer.setData("text/plain",""));(b=this.getContainer())&&b.handleDragStart()};VaultItemDisplay.prototype.handleDragEnd=function(b){b=e.getDragItems();for(var a=0,d=b.length;a<
d;++a){var h=b[a];h._parent&&h._parent.setDragTarget(!0);h._$_element.removeClass("dragStarted")}(b=this.getContainer())&&b.handleDragEnd()};VaultItemDisplay.prototype.buildDragElement=function(b){b=e.createElement("div",{"class":"dragItem"+(b?" last":"")});var a=e.createElement("div","dragIconContainer itemIcon"),d=this.getIconElement();d.setAttribute("class",d.getAttribute("class")+" dragIcon");a.appendChild(d);b.appendChild(a);a=e.createElement("div","dragName",this._model.getName());b.appendChild(a);
return b}})();(function(){AccountBaseDisplay.prototype.convertTimeToString=function(){var c=function(c,b,a){c=Math.floor(c);return c+" "+(1===c?b:a)+" "+Strings.Vault.AGO};return function(f){if(void 0===f||31536E3>f)return Strings.Vault.NEVER;f=e.get_gmt_timestamp()-f;return 0>f?Strings.Vault.JUST_NOW:60>f?c(f,Strings.Vault.SECOND,Strings.Vault.SECONDS):3600>f?c(f/60,Strings.Vault.MINUTE,Strings.Vault.MINUTES):86400>f?c(f/60/60,Strings.Vault.HOUR,Strings.Vault.HOURS):604800>f?c(f/60/60/24,Strings.Vault.DAY,
Strings.Vault.DAYS):2678400>f?c(f/60/60/24/7,Strings.Vault.WEEK,Strings.Vault.WEEKS):31536E3>f?c(f/60/60/24/31,Strings.Vault.WEEK,Strings.Vault.WEEKS):c(f/60/60/24/365,Strings.Vault.YEAR,Strings.Vault.YEARS)}}();AccountBaseDisplay.prototype.getLastTouchString=function(){return this.convertTimeToString(this._model.getLastTouch())};AccountBaseDisplay.prototype.buildItemInfoTextElements=function(){var c=VaultItemDisplay.prototype.buildItemInfoTextElements.apply(this,arguments);c.push(this.buildItemInfoTextElement([e.createElement("p",
"small infoLabel",Strings.Vault.LAST_USED),this.createTextElement("p",this.getLastTouchString,"small")]));return c};AccountBaseDisplay.prototype.getContextMenuItems=function(c){var f=VaultItemBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);c||f.push(new e.ContextMenuItem(Constants.ACTION_EDIT));f.push(new e.ContextMenuItem(Constants.ACTION_DELETE));f.push(new e.ContextMenuItem(Constants.ACTION_SHARE));c||f.push(new e.ContextMenuItem(Constants.ACTION_CLONE));f.push(new e.ContextMenuItem(Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU,
{divider:!0,submenu:!0}));this._parent.hasSubGroup()&&f.push(new e.ContextMenuItem(Constants.ACTION_OPEN_MOVE_TO_SUB_FOLDER_MENU,{divider:!0,submenu:!0}));return f};AccountBaseDisplay.prototype.getItemButtonActions=function(){var c=[Constants.ACTION_EDIT];this._model.isSharingEnabled()&&c.push(Constants.ACTION_SHARE);c.push(Constants.ACTION_DELETE);return c};AccountBaseDisplay.prototype.isExcludedAction=function(c,e){switch(c){case Constants.ACTION_COPY_USERNAME:case Constants.ACTION_COPY_PASSWORD:case Constants.ACTION_COPY_NOTE:case Constants.ACTION_COPY_URL:return!LPFeatures.allowClipboardCopy();
case Constants.ACTION_SHARE:return!this._model.isSharingEnabled()||!LPFeatures.allowIndividualSharing();default:return VaultItemDisplay.prototype.isExcludedAction.apply(this,arguments)}}})();(function(){AccountDisplay.prototype.buildItemIconElement=function(){var c=AccountBaseDisplay.prototype.buildItemIconElement.apply(this,arguments);this.bigImg||c.setAttribute("class",c.getAttribute("class")+" smallIcon");return c};AccountDisplay.prototype.getDisplayName=function(){if(this._model.hasGeneratedPassword()){var c=
Strings.Vault.GENERATED_PREFIX+" ",e=this._model.getName();if(0===e.indexOf(c))return e.substring(c.length)}return AccountBaseDisplay.prototype.getDisplayName.apply(this,arguments)};AccountDisplay.prototype.getUsernameValue=function(){return this._model.getUsername()};AccountDisplay.prototype.createSecondaryNameTextElement=function(){if(this.getUsernameValue())return this.createTextElement("p",this.getUsernameValue,"small infoLabel");if(this._model.hasGeneratedPassword()){var c=e.createElement("p",
"small infoLabel",Strings.Vault.GENERATED);c.insertBefore(e.createElement("i","badge warn small"),c.firstChild);return c}};AccountDisplay.prototype.getIconElement=function(){var c=m.getImage(this),f="smallIcon";this.bigImg&&(f="bigIcon");void 0===c||null===c?c="data:image/gif;base64,R0lGODlhEAAQAIcAAAAAAExnf1BpgWR0iHZ6hHeBkX+GkYiOmpeaopucoaSlqqWmqrm9w7q+xL+/wry/xcXGyc3Oz9HS1NPU1tnZ2d/h4+Di5OLj5uPl5+Tk5OXm6O7u7+7v8O/w8e/w8vDw8fHx8vLy8/Pz8/Pz9PT09fX19fX29vb29vf39/f3+Pj4+Pj4+fn5+vr6+/v7/Pz8/P39/f7+/v///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAAAALAAAAAAQABAAAAiQAAEIHEiw4MAFCBEmQCjBIIAFMiLK8CBjA4QIBiFu2Fgh4oYJDgpq5Chxw4KCCiqSlKigIAKVGyowYNDgAYGCB2BWsHABgwYDBQvA/CCiBAoVBQoOUNlBhAkVLV4MKCigIgenK1zAiCGgYICKIEhAhRExgFcZHEKcYEG27NkOI1K0aCvDLMEAePPqteuwr8CAADs=":
0===c.indexOf("lps lp")&&(f+=" "+c,c="../images/clear_icon.gif");return e.createElement("img",{"class":f,src:c})};AccountDisplay.prototype.getLaunchElementAction=function(){return Constants.ACTION_LAUNCH};AccountDisplay.prototype.getContextMenuItems=function(c){var f=AccountBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);c||(f.push(new e.ContextMenuItem(Constants.ACTION_COPY_USERNAME,{divider:!0})),f.push(new e.ContextMenuItem(Constants.ACTION_COPY_PASSWORD)),f.push(new e.ContextMenuItem(Constants.ACTION_COPY_URL)),
f.push(new e.ContextMenuItem(Constants.ACTION_GO_TO_URL,{divider:!0})));return f};AccountDisplay.prototype.isExcludedAction=function(c,e){switch(c){case Constants.ACTION_LAUNCH:case Constants.ACTION_GO_TO_URL:return!this._model.isURLLaunchable()||AccountBaseDisplay.prototype.isExcludedAction.apply(this,arguments);default:return AccountBaseDisplay.prototype.isExcludedAction.apply(this,arguments)}}})();(function(){ApplicationDisplay.prototype.getIconElement=AccountDisplay.prototype.getIconElement;ApplicationDisplay.prototype.getLaunchElementAction=
function(){return LPFeatures.allowLaunchApplication()?Constants.ACTION_LAUNCH:null};ApplicationDisplay.prototype.getItemButtonActions=function(){return[Constants.ACTION_EDIT,Constants.ACTION_DELETE]};ApplicationDisplay.prototype.getContextMenuItems=function(c){var f=VaultItemDisplay.prototype.getContextMenuItems.apply(this,arguments);c||(f.push(new e.ContextMenuItem(Constants.ACTION_COPY_USERNAME)),f.push(new e.ContextMenuItem(Constants.ACTION_COPY_PASSWORD)));f.push(new e.ContextMenuItem(Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU,
{divider:!0,submenu:!0}));this._parent.hasSubGroup()&&f.push(new e.ContextMenuItem(Constants.ACTION_OPEN_MOVE_TO_SUB_FOLDER_MENU,{divider:!0,submenu:!0}));c?f.push(new e.ContextMenuItem(Constants.ACTION_DELETE,{divider:!0})):(f.push(new e.ContextMenuItem(Constants.ACTION_EDIT,{divider:!0})),f.push(new e.ContextMenuItem(Constants.ACTION_DELETE)),f.push(new e.ContextMenuItem(Constants.ACTION_CLONE)));return f}})();(function(){GroupDisplay.prototype.handleEnter=function(){this.toggleOpen()};GroupDisplay.prototype.focus=
function(){this._element.children[0].children[0].focus()};GroupDisplay.prototype.handleClickEvent=function(a,d){switch(a){case Constants.ACTION_OPEN_ALL:m.openAll(this.getItemModelChildren());break;case Constants.ACTION_TOGGLE_OPEN:this.toggleOpen();break;case Constants.ACTION_EXPAND_ALL:this.expandAll();break;case Constants.ACTION_COLLAPSE_ALL:this.collapseAll();break;default:VaultItemBaseDisplay.prototype.handleClickEvent.apply(this,arguments)}};GroupDisplay.prototype.getModelItemsForAction=function(a){switch(a){case Constants.ACTION_PURGE:case Constants.ACTION_RESTORE:return this.getItemModelChildren();
case Constants.ACTION_SHARE:return this.getItemModelChildren(!0).concat(this.getAllSubGroupModels(!0));case Constants.ACTION_DELETE:return this.getItemModelChildren(!0).concat(this.getAllSubGroupModels(!0)).concat(this._model);case Constants.ACTION_MOVE_TO_FOLDER:return this.getItemModelChildren(!0).concat(this.getAllSubGroupModels(!0));default:VaultItemBaseDisplay.prototype.getModelItemsForAction.apply(this,arguments)}};GroupDisplay.prototype.isDeleted=function(){return!0===this._deleted};GroupDisplay.prototype.setDeleted=
function(){this._deleted=!0};GroupDisplay.prototype.updateTextElements=function(){VaultItemBaseDisplay.prototype.updateTextElements.apply(this,arguments);this._parent&&this._parent.updateTextElements.apply(this._parent,arguments)};GroupDisplay.prototype.updateView=function(){var a=this.getLevel();VaultItemDisplay.prototype.updateView.apply(this,arguments);this.getLevel()!==a&&this.rebuild()};GroupDisplay.prototype.isExcludedAction=function(a,d){switch(a){case Constants.ACTION_SHARE:return!LPFeatures.allowSharedFolders();
default:return VaultItemBaseDisplay.prototype.isExcludedAction.apply(this,arguments)}};GroupDisplay.prototype.parseExcludeActions=function(){var a=e.getOption(this._buildOptions,"excludeActions",null);if(a){for(var d={},b=0,c=a.length;b<c;++b)d[a[b]]=!0;this._buildOptions.excludeActions=d}};GroupDisplay.prototype.isEmpty=function(a){return 0===this.getChildren(a).length};GroupDisplay.prototype.applyToChildren=function(a,d){for(var b=this.getChildren(d),c=0,e=b.length;c<e;++c)this.applyToChild(a,b[c])};
GroupDisplay.prototype.applyToChild=function(a,d){switch(typeof a){case "string":d[a].apply(d);break;case "function":a.call(this,d)}};GroupDisplay.prototype.select=function(){this.applyToChildren("select")};GroupDisplay.prototype.destruct=function(){this._destructed||(this.applyToChildren(function(a){a.setParent(null);a.destruct()},!0),this._$_stickyFolder&&this._$_stickyFolder.remove(),VaultItemBaseDisplay.prototype.destruct.apply(this))};GroupDisplay.prototype.getLabel=function(){return this._model.getGroupName()+
" ("+this._itemCount+")"};GroupDisplay.prototype.getItemCount=function(){return this._itemCount};GroupDisplay.prototype.displayAsList=function(){this._element&&this.applyToChildren("displayAsList",!0)};GroupDisplay.prototype.displayAsGrid=function(){this._element&&this.applyToChildren("displayAsGrid",!0)};GroupDisplay.prototype.buildItem=function(a,d,b){a.preBuild(d);var h=a.build(d);b&&b.appendChild(h);a.postBuild(h,d)};GroupDisplay.prototype.buildItems=function(a,d,b){b=b||this.getBuildOptions();
"function"===typeof b.sortFunction&&a.sort(b.sortFunction);for(var h=0,c=a.length;h<c;++h)this.buildItem(a[h],b,d);0<a.length&&a[a.length-1].addClass("last")};GroupDisplay.prototype.sortItems=function(a,d,b,c){a.sort(b);if(d){(void 0===c||c)&&e.removeDOMChildren(d);b=0;for(c=a.length;b<c;++b){var h=a[b];h._$_element.removeClass("last");d.appendChild(h._element)}0<a.length&&a[a.length-1].addClass("last")}return a};GroupDisplay.prototype.buildFolderElement=function(a){var d=this.getLevel(),b="folderContainer";
0<d&&(b+=" tab"+d);d=e.createElement("div",b);b={"class":"folderLabel",vaultaction:Constants.ACTION_TOGGLE_OPEN};a.keyboardNavigation&&(b.tabindex="0");d.appendChild(this.createTextElement("div",this.getLabel,b));return d};GroupDisplay.prototype.build=function(a){a=a||{};var d="folder";this.DISPLAY_OPTIONS.COMPACT&&(d+=" "+this.COMPACT_CLASS);d=e.createElement("div",d);d.appendChild(this.buildFolderElement(a));"undefined"!==typeof a.additionalGroupClasses&&e.addClass(d,a.additionalGroupClasses);var b=
e.createElement("div","contents");d.appendChild(b);this._itemContents=e.createElement("div","itemContents");this._subFolderContents=e.createElement("div","subFolderContents");b.appendChild(this._itemContents);b.appendChild(this._subFolderContents);this.buildItems(this.getSubGroups(),this._subFolderContents,a);this.buildItems(this.getItems(),this._itemContents,a);this.usesStickyFolders()&&this.buildStickyFolder(a);return d};GroupDisplay.prototype.setElement=function(a){VaultItemBaseDisplay.prototype.setElement.apply(this,
arguments);this.folderLabel=c(this._$_element).get(0)};GroupDisplay.prototype.setAccesibilityAttributes=function(){this.folderLabel&&(this.folderLabel.setAttribute("role","button"),this.folderLabel.setAttribute("aria-expanded","true"),this.folderLabel.setAttribute("aria-label",this._model.toString()))};GroupDisplay.prototype.preBuild=function(){VaultItemBaseDisplay.prototype.preBuild.apply(this,arguments);this._itemCount=this.getItemChildren().length};GroupDisplay.prototype.postBuild=function(){VaultItemBaseDisplay.prototype.postBuild.apply(this,
arguments);this._contents=this._$_element.find(".contents").first();this._expanded||(this.addCollapsedClasses(),this._contents.hide())};GroupDisplay.prototype.buildStickyFolder=function(a){this._stickyFolder=this.buildFolderElement(g.extend({},a,{keyboardNavigation:!1}));this._$_stickyFolder=g(this._stickyFolder);this._$_stickyFolder.addClass("stickyFolder");this._$_stickyFolder.css("z-index",-this.getLevel());this.setupListeners(this._$_stickyFolder,a)};GroupDisplay.prototype.getLabelHeight=function(){var a;
return function(){void 0===a&&(a=this._$_element.find(".folderContainer").outerHeight());return a}}();GroupDisplay.prototype.getOffsetTop=function(){var a;return function(){void 0===a&&(a=Math.min(0,parseInt(this._$_element.css("margin-top"))));return this._element.offsetTop-a}}();GroupDisplay.prototype.getOffsetBottom=function(){var a;return function(){void 0===a&&(a=Math.max(0,parseInt(this._$_element.css("margin-bottom"))));return this._element.offsetTop+this._element.clientHeight+a}}();var c=
function(a){return(a.hasClass("folderContainer")?a:a.children(".folderContainer")).children(".folderLabel")};GroupDisplay.prototype.setupListeners=function(a,d){var b=c(a);b.bind("click",this._eventHandler);b.bind("contextmenu",this._eventHandler);d.keyboardNavigation&&b.bind("keydown",this._eventHandler);if("undefined"===typeof d.allowDrop||d.allowDrop)a.bind("dragover",this._eventHandler),a.bind("drop",this._eventHandler),a.bind("dragenter",this._eventHandler),a.bind("dragleave",this._eventHandler)};
GroupDisplay.prototype.displayCompact=function(){VaultItemBaseDisplay.prototype.displayCompact.apply(this,arguments);this._element&&this.applyToChildren("displayCompact",!0)};GroupDisplay.prototype.displayLarge=function(){VaultItemBaseDisplay.prototype.displayLarge.apply(this,arguments);this._element&&this.applyToChildren("displayLarge",!0)};GroupDisplay.prototype.toggleOpen=function(){this._expanded?this.collapse():this.expand();var a=this.getContainer();a._buildOptions.folderStateChange&&a._buildOptions.folderStateChange(a)};
GroupDisplay.prototype.removeCollapsedClasses=function(){this._$_element.removeClass("closed");this.folderLabel.setAttribute("aria-expanded","true");this._$_stickyFolder&&this._$_stickyFolder.removeClass("closed")};GroupDisplay.prototype.addCollapsedClasses=function(){this._contents.css("height","");this._$_element.addClass("closed");this.folderLabel.setAttribute("aria-expanded","false");this._$_stickyFolder&&this._$_stickyFolder.addClass("closed")};GroupDisplay.prototype.expand=function(){this._expanded||
(this._element&&(this.removeCollapsedClasses(),this._contents.slideDown(200)),this._expanded=!0)};GroupDisplay.prototype.expandAll=function(){this.expand();this.applyToChildren("expandAll")};GroupDisplay.prototype.collapse=function(){if(this._expanded){if(this._element){var a=this.getContainer();a&&this.usesStickyFolders()&&(a=a.scrollParent,this.getOffsetTop()<a.scrollTop()&&a.scrollTop(this._element.offsetTop-this._stickyFolder.offsetTop));this._contents.slideUp(200);this.addCollapsedClasses()}this._expanded=
!1}};GroupDisplay.prototype.collapseAll=function(){this.collapse();this.applyToChildren("collapseAll")};GroupDisplay.prototype.isExpanded=function(){return this._expanded};GroupDisplay.prototype.hasSubGroup=function(){return 0<this.getSubGroups().length};GroupDisplay.prototype.getAllSubGroups=function(a){for(var d=this.getSubGroups(a),b=0,c=d.length;b<c;++b)d=d.concat(d[b].getAllSubGroups(a));return d};GroupDisplay.prototype.getAllSubGroupModels=function(a){return p(this.getAllSubGroups(a))};GroupDisplay.prototype.getAllSubGroupsOrdered=
function(a){for(var d=[],b=this.getSubGroups(a),c=0,e=b.length;c<e;++c){var f=b[c];f._shown&&(d.push(f),d=d.concat(f.getAllSubGroupsOrdered(a)))}return d};GroupDisplay.prototype.reattachElement=function(){this._parent._subFolderContents.appendChild(this._element)};GroupDisplay.prototype.getSearchOptions=function(){return{searchNotes:m.getPreference("searchNotes",!0)}};GroupDisplay.prototype.parseSearchTerms=function(a){a=a.trim().split(" ");for(var d=[],b=0,c=a.length;b<c;++b)0<a[b].length&&d.push(a[b]);
return d};GroupDisplay.prototype.applySearch=function(a,d){a instanceof Array||(a=this.parseSearchTerms(a));if(d.moreSpecific&&!this._shown)return null;a=a.slice();if(0<a.length&&VaultItemBaseDisplay.prototype.applySearch.call(this,a,g.extend({},d,{removeMatchingTerms:!0})))return this.showAllChildren(d.ignoreFilterOnSearch),this.expand(!1),this._itemCount;for(var b=!1,c=this.getChildren(d.ignoreFilterOnSearch),e=this._itemCount=0,f=c.length;e<f;++e){var q=c[e].applySearch(a,d);null!==q&&(this._itemCount+=
q,b=!0)}0<a.length&&!b?this.hide():(this.show(),this.updateTextElements());0===a.length&&this.applyFilter(this._filter,{shouldRecurse:!1,forceFilter:!0});return b?this._itemCount:null};GroupDisplay.prototype.getSearchResultItems=function(a,d){if(0<a.length&&this.matches(a,d))return this.getItemChildren();for(var b=this.getChildren(d.ignoreFilterOnSearch),c=[],e=0,f=b.length;e<f;++e){var g=b[e].getSearchResultItems(a,d);null!==g&&(c=c.concat(g))}return c};GroupDisplay.prototype.handleDragEnter=function(a){if(this._dragTarget&&
(this._$_element.toggleClass("dragTarget"),a.preventDefault(),this._$_element.hasClass("closed"))){var d=this;this._openTimeouts.push(setTimeout(function(){d.expand()},500))}a.stopPropagation()};GroupDisplay.prototype.setDragTarget=function(a){this._dragTarget=a};GroupDisplay.prototype.handleDragLeave=function(a){if(this._dragTarget){this._$_element.toggleClass("dragTarget");a.preventDefault();var d=this._openTimeouts.pop();void 0!==d&&clearTimeout(d)}a.stopPropagation()};GroupDisplay.prototype.handleDragOver=
function(a){this._dragTarget&&a.preventDefault();a.stopPropagation()};GroupDisplay.prototype.handleDrop=function(a){if(this._dragTarget){this._$_element.removeClass("dragTarget");for(var d=e.getDragItems(),b=0,c=d.length;b<c;++b)d[b]._parent.setDragTarget(!0);this.moveToFolder(p(d));a.preventDefault();a.stopPropagation()}};GroupDisplay.prototype.moveToFolder=function(a){0<a.length&&a[0].moveToFolder(this._model,a)};var f=function(a,d){for(var b=0,c=d.length;b<c;++b)if(a===d[b])return d.splice(b,1),
!0};GroupDisplay.prototype.removeChild=function(a){var d=this._filter&&!1===this._filter.showEmptyGroups&&!this.isEmpty();f(a,this._items)?(this.updateItemCount(-1),this._filteredItems=null):(f(a,this._subGroups),this.updateItemCount(-a._itemCount),this._filteredSubGroups=null);a.setParent(null);a._element&&a._element.parentElement&&a._element.parentElement.removeChild(a._element);Topics.get(Topics.REAPPLY_SEARCH).publish(this,this.getSearchOptions());d&&this.isEmpty()&&(a=this.getContainer())&&a.checkForStateChange(function(a){return function(){a.applyFilterToParents()}}(this));
this.updateTextElements()};GroupDisplay.prototype.getLevel=function(){for(var a=0,d=this._parent;d._parent;)++a,d=d._parent;return a};GroupDisplay.prototype.updateItemCount=function(a){this._itemCount+=a;this._parent&&this._parent.updateItemCount(a)};GroupDisplay.prototype.addChild=function(a,d){a instanceof Array||(a=[a]);for(var b=this.getContainer(),c=this.getBuildOptions(),f=[],g=[],q=0,l=a.length;q<l;++q){var n=a[q];n._parent!==this&&(n._parent&&n._parent.removeChild(n),n instanceof GroupDisplay?
(this.updateItemCount(n._itemCount),this._subGroups.push(n),this._filteredSubGroups=null,f.push(n)):(this.updateItemCount(1),this._items.push(n),this._filteredItems=null,g.push(n)),n.setParent(this),null!==this._element&&null===n._element&&this.buildItem(n,c))}c&&(0<g.length&&this.sortItems(this.getItems(!0),this._itemContents,c.sortFunction),0<f.length&&this.sortItems(this.getSubGroups(!0),this._subFolderContents,c.sortFunction,this._subFolderContents!==this._itemContents));this._filter&&b?b.checkForStateChange(function(a){return function(){a.applyFilterToParents()}}(this)):
this._shown||this.show();this.updateTextElements();e.getOption(d,"scrollIntoView",!0)&&b&&b.scrollParent&&(1===g.length?b.scrollParent.scrollTop(a[0].getScrollTop()):1<g.length&&b.scrollParent.scrollTop(this.getScrollTop()))};GroupDisplay.prototype.applyFilterToParents=function(){for(var a=this;a;)a.applyFilter(a._filter,{shouldRecurse:!1,forceFilter:!0}),a=a._parent};GroupDisplay.prototype.sortChildren=function(a){var d=this.getSubGroups(!0);this.sortItems(d,this._subFolderContents,a);this.sortItems(this.getItems(!0),
this._itemContents,a,this._subFolderContents!==this._itemContents);this.getSubGroups().sort(a);this.getItems().sort(a);for(var b=0,c=d.length;b<c;++b)d[b].sortChildren(a)};GroupDisplay.prototype.getContextMenuItems=function(a){var d=VaultItemBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);d.push(new e.ContextMenuItem(Constants.ACTION_RENAME));this._model.isSharingEnabled()&&d.push(new e.ContextMenuItem(Constants.ACTION_SHARE));d.push(new e.ContextMenuItem(Constants.ACTION_DELETE,{text:Strings.Vault.DELETE_FOLDER}));
d.push(new e.ContextMenuItem(Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU,{divider:!0,submenu:!0}));d.push(new e.ContextMenuItem(Constants.ACTION_CREATE_SUB_FOLDER));d.push(new e.ContextMenuItem(Constants.ACTION_OPEN_ALL,{divider:!0}));return d};GroupDisplay.prototype.getChildren=function(a){return this.getItems(a).concat(this.getSubGroups(a))};GroupDisplay.prototype.getAllChildrenOrdered=function(){var a=function(a){a=this.getSubGroups(a);for(var d=[],b=0,c=a.length;b<c;++b){var e=a[b];e._shown&&(d.push(e),
e._expanded&&(d=d.concat(e.getAllChildrenOrdered())))}return d};return function(d,b){for(var c=this.getItems(d),e=[],h=0,f=c.length;h<f;++h)c[h]._shown&&e.push(c[h]);return e.concat(a.call(this,d))}}();GroupDisplay.prototype.getChildrenIncludingFavorites=GroupDisplay.prototype.getChildren;GroupDisplay.prototype.applyFilter=function(a,d){var b=e.getOption(d,"forceFilter",!1);if(a&&(null===this._filter||this._filter!==a||b)){var c=e.getOption(d,"shouldRecurse",!0),f=e.getOption(d,"recursed",!1),g=this instanceof
Container||void 0===a.func||a.func(this);if(c||!f){d=d||{};d.recursed=!0;for(var c=this.getChildren(!0),q=f=0,l=c.length;q<l;++q)f+=c[q].applyFilter(a,d);this._itemCount=f;this.updateTextElements()}if(this._filter!==a||b)this._filter=a,this._filteredItems=null,this._filteredItems=this.getItems(),this._filteredSubGroups=null,this._filteredSubGroups=this.getSubGroups();0===this._itemCount&&!a.showEmptyGroups||!g?this.hide():this.show()}return this._itemCount};var b=function(a){this._itemCount+=a.showAllChildren()};
GroupDisplay.prototype.showAllChildren=function(a){this._itemCount=0;this.applyToChildren(b,a);this.updateTextElements();return this._itemCount};GroupDisplay.prototype.getItemModelChildren=function(a){return p(this.getItemChildren(a))};GroupDisplay.prototype.getItemChildren=function(a){for(var b=this.getItems(a),c=this.getSubGroups(a),e=0,f=c.length;e<f;++e)b=b.concat(c[e].getItemChildren(a));return b};GroupDisplay.prototype.getItems=function(a){if(null===this._filter||a)return this._items;if(null===
this._filteredItems){this._filteredItems=[];a=0;for(var b=this._items.length;a<b;++a){var c=this._items[a];(void 0===this._filter.func||this._filter.func(c))&&this._filteredItems.push(c)}}return this._filteredItems};GroupDisplay.prototype.getSubGroupModels=function(a){return p(this.getSubGroups(a))};GroupDisplay.prototype.getSubGroups=function(a){if(null===this._filter||a)return this._subGroups;if(null===this._filteredSubGroups){this._filteredSubGroups=[];a=0;for(var b=this._subGroups.length;a<b;++a){var c=
this._subGroups[a];(void 0===this._filter.func||this._filter.func(c))&&(0<c._itemCount||this._filter.showEmptyGroups)&&this._filteredSubGroups.push(c)}}return this._filteredSubGroups};GroupDisplay.prototype.show=function(){VaultItemBaseDisplay.prototype.show.apply(this,arguments);this._parent&&this._parent.show()};GroupDisplay.prototype.processItems=function(a,b){if(a instanceof Array)for(var d=0,c=a.length;d<c;++d)b.call(this,a[d]);else b.call(this,a)};(function(){Container.prototype.initialize=
function(a,b){null===this._element&&(this.setElement(a),this.scrollParent=b,this.favoritesGroup&&(this._favoriteElement=e.createElement("div"),a.appendChild(this._favoriteElement),this.buildItems([this.favoritesGroup],this._favoriteElement,this.favoritesGroup.getBuildOptions()),this.favoritesGroup.isEmpty()&&this.favoritesGroup.hide()),e.getOption(this._buildOptions,"separateItems",!1)?(this._itemContents=e.createElement("div","itemContentPadding itemContents"),this._subFolderContents=e.createElement("div",
"folderWrapper"),a.appendChild(this._itemContents),a.appendChild(this._subFolderContents)):this._subFolderContents=this._itemContents=a,this.buildItems(this.getSubGroups(),this._subFolderContents,this._buildOptions),this.buildItems(this.getItems(),this._itemContents,this._buildOptions),this._folderView||this.sortItemsNoFolder(this._buildOptions.sortFunction),this.usesStickyFolders()&&(this.updatedStickyFolderContainer=!1,this.stickyFoldersContainer=e.createElement("div","stickyFoldersContainer folder"),
this.$stickyFoldersContainer=g(this.stickyFoldersContainer),this._buildOptions.stickyFolderParent.insertBefore(this.stickyFoldersContainer,this._buildOptions.stickyFolderParent.firstElementChild),function(a){var b=!1;a.scrollHandler=function(d){a._$_element.is(":visible")&&a._folderView&&("function"===typeof requestAnimationFrame?b||(requestAnimationFrame(function(c){0<c&&a.updateStickyFolders(d.target.scrollTop);b=!1}),b=!0):a.updateStickyFolders(d.target.scrollTop))};a.scrollParent.scroll(a.scrollHandler)}(this)))};
Container.prototype.displayItemsInSpecifiedGroup=function(){return!0};Container.prototype.getScrollTop=function(){return 0};Container.prototype.usesStickyFolders=function(){return e.getOption(this._buildOptions,"stickyFolders",!1)};Container.prototype.updateStickyFolders=function(a){if(null!==this._$_element){this.updatedStickyFolderContainer||(this.$stickyFoldersContainer.css("right",this.scrollParent.width()-this._$_element.width()),this.updatedStickyFolderContainer=!0);var b=[];e.removeDOMChildren(this.stickyFoldersContainer);
for(var d=this.getAllSubGroupsOrdered(),c=0,f=d.length;c<f;++c){var g=d[c],l=!1,n=g.getOffsetTop()-a;if(0>n&&g.getOffsetBottom()>a)l=!0;else if(0<=n)if(l=b.length*g.getLabelHeight(),n<l){var m=g.getLevel(),p=b[m];if(p)if(0<m&&l-n>(b.length-m)*g.getLabelHeight())b=b.slice(0,m),l=!0;else{p.css("margin-top",Math.min(0,n-l));break}else l=!0}else break;l&&(g._$_stickyFolder.css("margin-top",""),b[g.getLevel()]=g._$_stickyFolder)}this.$stickyFoldersContainer.append(b)}};Container.prototype.updateView=function(){};
Container.prototype.matches=function(a,b){return null};Container.prototype.getChildrenIncludingFavorites=function(a){var b=GroupDisplay.prototype.getChildrenIncludingFavorites.apply(this,arguments);this.favoritesGroup&&b.unshift(this.favoritesGroup);return b};Container.prototype.getAllSubGroupsIncludingFavorites=function(a){a=this.getAllSubGroups(a);this.favoritesGroup&&(a=a.concat(this.favoritesGroup));return a};GroupDisplay.prototype.getSortedItems=function(a){if(null===this._filter||a)return this._sortedItems;
if(null===this._sortedFilteredItems){this._sortedFilteredItems=[];a=0;for(var b=this._sortedItems.length;a<b;++a){var d=this._sortedItems[a];(void 0===this._filter.func||this._filter.func(d))&&this._sortedFilteredItems.push(d)}}return this._sortedFilteredItems};Container.prototype.applyFilter=function(a,b){e.getOption(b,"checkForStateChange",!0)?this.checkForStateChange(GroupDisplay.prototype.applyFilter,arguments):GroupDisplay.prototype.applyFilter.apply(this,arguments);this._buildOptions.multiSelect=
e.getOption(a,"multiSelect",!0);this.favoritesGroup&&this.favoritesGroup.applyFilter(a,b)};Container.prototype.applyToChildren=function(a,b){GroupDisplay.prototype.applyToChildren.apply(this,arguments);this.favoritesGroup&&this.applyToChild(a,this.favoritesGroup)};Container.prototype.getSearchResultItems=function(a,b){var d=GroupDisplay.prototype.getSearchResultItems.call(this,this.parseSearchTerms(a),g.extend(b,this.getSearchOptions(a)));d.sort(VaultItemBaseDisplay.prototype.sortByNameAsc);return d};
Container.prototype.getSearchOptions=function(a){var b=GroupDisplay.prototype.getSearchOptions.apply(this,arguments);b.ignoreFilterOnSearch=this._buildOptions.ignoreFilterOnSearch;var d=!1;this._lastSearchTerm&&a&&a.length>this._lastSearchTerm.length&&(d=a.split(" ").length===this._lastSearchTerm.split(" ").length);b.moreSpecific=d;return b};Container.prototype.shouldSearch=function(a){return null===this._lastSearchTerm?0<a.length:this._lastSearchTerm!==a};Container.prototype.applySearch=function(a,
b){a=a.trim();if(this.shouldSearch(a)){b=g.extend(b,this.getSearchOptions(a));this._lastSearchTerm=a;var d=this.parseSearchTerms(a);this._$_element.hide();var c=GroupDisplay.prototype.applySearch.call(this,d,b);this._element.removeAttribute("style");this.favoritesGroup&&this.favoritesGroup.applySearch(d,b);return c}};Container.prototype.hide=function(){e.removeDOMChildren(this.stickyFoldersContainer)};Container.prototype.show=function(){};Container.prototype.checkForStateChange=function(a,b){if("function"===
typeof this._buildOptions.stateChangeCallback){var d=this.isEmpty();a.apply(this,b);d!==this.isEmpty()&&this._buildOptions.stateChangeCallback(!d,this)}else a.apply(this,b)};Container.prototype.getGroupDisplay=function(a){for(var b=this.getAllSubGroups(),d=0,c=b.length;d<c;++d)if(b[d]._model===a)return b[d];return null};Container.prototype.addDummyGroups=function(a,b){var d=m.addDummyGroups(a);d.push(a);for(var c,e=d[0].getGroupParentName();!c&&e;)e=m.getGroupByName(e),(c=this.getGroupDisplay(e))||
d.unshift(e),e=e.getGroupParentName();c||(c=this);for(var e=[],f=0,h=d.length;f<h;++f)e.push(d[f].newDisplayObject());d=0;for(f=e.length-1;d<f;++d)e[d].addChild(e[d+1]);GroupDisplay.prototype.addChild.call(c,e[0],b);return e[e.length-1]};Container.prototype.removeChild=function(){this.checkForStateChange(GroupDisplay.prototype.removeChild,arguments)};Container.prototype.addChild=function(){var a=function(a){a._model.isFavorite()&&this.addFavorite(a._model)},b=function(b,d,c){if(d){var e=this.getGroupDisplay(d);
e||(e=this.addDummyGroups(d,c));e.addChild(b,c)}else GroupDisplay.prototype.addChild.call(this,b,c);this.processItems(b,a)};return function(){this.checkForStateChange(b,arguments)}}();Container.prototype.getSelectedItems=function(){return this._selectedItems.slice()};Container.prototype.getSelectedModelItems=function(){for(var a=[],b=0,c=this._selectedItems.length;b<c;++b)a.push(this._selectedItems[b]._model);return a};Container.prototype.removeSelectedItem=function(a,b){b&&this._lastToggleSelectTarget&&
this._lastToggleSelectTarget!==a&&(this.shiftSelect(a,this._lastToggleSelectTarget,"deselect"),this._lastToggleSelectTarget.deselect());for(var d=0,c=this._selectedItems.length;d<c;++d)if(a===this._selectedItems[d]){this._selectedItems.splice(d,1);break}d=this._selectedItems.length;e.getOption(this._buildOptions,"publishSelect",!0)?(0===d&&Topics.get(Topics.ITEMS_DESELECTED).publish(),Topics.get(Topics.SELECT_COUNT_CHANGE).publish(d)):this.callSelectCallback(d)};Container.prototype.callSelectCallback=
function(a){var b=e.getOption(this._buildOptions,"selectCallback",null);"function"===typeof b&&b(a)};var a=function(b,c,e){if(0<b.length)for(var d=b.pop(),f=d._parent.getChildrenIncludingFavorites(),g=0,h=f.length;g<h;++g){var k=f[g];k===d?(a(b,c,e),c=!c):c&&k[e].apply(k)}};Container.prototype.shiftSelectSimple=function(a,b,c){for(var d=null,e=this.getSortedItems(),f=0,g=e.length;f<g;++f){var h=e[f];if(h===a||h===b)if(null===d)d=!0;else break;else d&&h[c].apply(h)}};Container.prototype.shiftSelect=
function(b,c,e){if(c)if(this._folderView){for(var d=[b],f=[c];b._parent!==c._parent;)null!==b._parent&&(b=b._parent,d.push(b)),null!==c._parent&&(c=c._parent,f.push(c));for(;0<d.length&&0<f.length&&d[d.length-1]===f[f.length-1];)d.pop(),f.pop();b=d.pop();c=f.pop();for(var g=!1,h=b._parent.getChildrenIncludingFavorites(),k=0,l=h.length;k<l;++k){var m=h[k];m===b||m===c?(m===b?a(d,g,e):a(f,g,e),g=!g):g&&m[e].apply(m)}}else this.shiftSelectSimple(b,c,e)};Container.prototype.addSelectedItems=function(a,
b){var d=0===this._selectedItems.length,c=e.getOption(this._buildOptions,"multiSelect",!0);b&&c&&this._lastToggleSelectTarget&&this._lastToggleSelectTarget!==a&&(this.shiftSelect(a,this._lastToggleSelectTarget,"select"),this._lastToggleSelectTarget.select());this._selectedItems.push(a);!c&&this._lastToggleSelectTarget&&this._lastToggleSelectTarget!==a&&this._lastToggleSelectTarget.deselect();e.getOption(this._buildOptions,"publishSelect",!0)?(d&&Topics.get(Topics.ITEMS_SELECTED).publish(),Topics.get(Topics.SELECT_COUNT_CHANGE).publish(this._selectedItems.length)):
this.callSelectCallback(this._selectedItems.length)};Container.prototype.pushSelectTarget=function(a){this._selectedStack.push(a)};Container.prototype.clearSelected=function(){if(0<this._selectedItems.length){e.getOption(this._buildOptions,"publishSelect",!0)?(Topics.get(Topics.ITEMS_DESELECTED).publish(),Topics.get(Topics.SELECT_COUNT_CHANGE).publish(0)):this.callSelectCallback(0);for(var a=this._selectedItems.slice(),b=0,c=a.length;b<c;++b)a[b].deselect()}this._selectedItems=[];this._lastToggleSelectTarget=
null};Container.prototype.createSelectionContextMenu=function(){var a=this.getSelectedItems();return 0<a.length?a[0].createContextMenu():null};Container.prototype.destruct=function(){if(!this._destructed){this.scrollHandler&&this.scrollParent.unbind("scroll",this.scrollHandler);this.searchInput&&this.searchInput.unbind("keydown.containerSearchNav");this.clearSelected();for(var a=0,b=this._subscriptions.length;a<b;++a){var c=this._subscriptions[a];c.topic.unsubscribe(c.callback)}this._$_element&&this._$_element.empty();
this.$stickyFoldersContainer&&this.$stickyFoldersContainer.remove();GroupDisplay.prototype.destruct.apply(this)}};Container.prototype.collapse=function(){};Container.prototype.open=function(){};Container.prototype.setFolderView=function(a){this._folderView=a;this._$_element&&(a?this._$_element.removeClass("itemView"):(this._$_element.addClass("itemView"),e.removeDOMChildren(this.stickyFoldersContainer)))};Container.prototype.sortByFolder=function(a){a=a?this.sortByNameAsc:this.sortByNameDesc;if(a!==
this._buildOptions.sortFunction||e.getOption(this._filter,"hasFolderView",!0)&&!this._folderView)this._buildOptions.sortFunction=a,this.setFolderView(!0),this.sortChildren(a),this._sortedItems=null;this.favoritesGroup&&this.favoritesGroup.show()};Container.prototype.sortByName=function(a){a=a?this.sortByNameAsc:this.sortByNameDesc;(a!==this._buildOptions.sortFunction||e.getOption(this._filter,"hasFolderView",!0)&&this._folderView)&&this.sortItemsNoFolder(a)};Container.prototype.sortItemsByMostRecent=
function(){(this._buildOptions.sortFunction!==this.sortByMostRecent||e.getOption(this._filter,"hasFolderView",!0)&&this._folderView)&&this.sortItemsNoFolder(this.sortByMostRecent)};Container.prototype.sortItemsNoFolder=function(a){this._buildOptions.sortFunction=a;this.setFolderView(!1);e.removeDOMChildren(this._subFolderContents);this._element&&(this._sortedItems=this.sortItems(this.getItemChildren(!0),this._itemContents,a));this.favoritesGroup&&this.favoritesGroup.hide()};Container.prototype.handleDragStart=
function(){this.$stickyFoldersContainer&&this.$stickyFoldersContainer.hide()};Container.prototype.handleDragEnd=function(){this.$stickyFoldersContainer&&this.$stickyFoldersContainer.show()};Container.prototype.getAllChildrenOrdered=function(){if(!this._folderView)return this.getSortedItems();var a=[];this.favoritesGroup&&!this.favoritesGroup.isEmpty()&&this.favoritesGroup._shown&&(a.push(this.favoritesGroup),this.favoritesGroup._expanded&&(a=a.concat(this.favoritesGroup.getAllChildrenOrdered())));
return a.concat(GroupDisplay.prototype.getAllChildrenOrdered.apply(this,arguments))};Container.prototype.getAllSubGroupsOrdered=function(){var a=GroupDisplay.prototype.getAllSubGroupsOrdered.apply(this,arguments);this.favoritesGroup&&this.favoritesGroup._shown&&!this.favoritesGroup.isEmpty()&&a.unshift(this.favoritesGroup);return a}})()})();(function(){SharedGroupDisplay.prototype.getSharedFolderLabel=function(){var c=[];this._model.isReadOnly()&&c.push(Strings.Vault.READ_ONLY);c.push(Strings.Vault.SHARED_FOLDER);
return c.join(" "+String.fromCharCode(8226)+" ")};SharedGroupDisplay.prototype.buildFolderElement=function(c){var e=GroupDisplay.prototype.buildFolderElement.apply(this,arguments);e.appendChild(this.createTextElement("div",this.getSharedFolderLabel,"sharedFolderLabel"));return e};SharedGroupDisplay.prototype.getContextMenuItems=function(c){var f=GroupDisplay.prototype.getContextMenuItems.apply(this,arguments);f.unshift(new e.ContextMenuItem(Constants.ACTION_STOP_DOWNLOADING));f.unshift(new e.ContextMenuItem(Constants.ACTION_MANAGE));
return f};SharedGroupDisplay.prototype.isExcludedAction=function(c,e){switch(c){case Constants.ACTION_CREATE_SUB_FOLDER:return this._model.isReadOnly();case Constants.ACTION_OPEN_MOVE_TO_FOLDER_MENU:return!0;default:return GroupDisplay.prototype.isExcludedAction.apply(this,arguments)}};SharedGroupDisplay.prototype.updateView=function(){if(this._model.isDeleted()||!this._model.isDownloaded())this.destruct();else{GroupDisplay.prototype.updateView.apply(this,arguments);for(var c=this.getItemModelChildren(!0).concat(this.getAllSubGroupModels(!0)),
e=0,b=c.length;e<b;++e){var a=c[e],d=a._data.group,g=d.indexOf("\\");a._data.group=this._model.getName()+(-1<g?d.substring(g):"")}}}})();(function(){LinkedGroupDisplay.prototype.getContextMenuItems=function(c){c=[];c.push(new e.ContextMenuItem(Constants.ACTION_UNLINK));c.push(new e.ContextMenuItem(Constants.ACTION_CREATE_SUB_FOLDER));c.push(new e.ContextMenuItem(Constants.ACTION_OPEN_ALL,{divider:!0}));return c};LinkedGroupDisplay.prototype.getSharedFolderLabel=function(){return Strings.Vault.LINKED_PERSONAL_ACCOUNT}})();
(function(){EmergencyAccessGroupDisplay.prototype.getSharedFolderLabel=function(){return Strings.Vault.EMERGENCY_ACCESS}})();(function(){FavoritesGroup.prototype.show=function(){this.isEmpty()||DefaultGroupDisplay.prototype.show.apply(this,arguments)};FavoritesGroup.prototype.moveToFolder=function(c){var e=this.getContainer();if(e&&0<c.length){var b=c[0];b.passwordProtect(function(){LPRequest.makeUpdateRequest(m.addToFavorites,{parameters:[c],success:function(){for(var a=0,d=c.length;a<d;++a)e.addFavorite(c[a]);
b.publishSuccess(Strings.translateString("added to Favorites"),c.length)}})},{itemsForAction:c})}}})();(function(){var c=function(c,b){this.path=c;this.css=b};NoteDisplay.prototype.NOTE_TYPES={};NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.AMEX]=new c("images/vault_4.0/secureNoteIcons/Amex.png","noteAmex");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.BANK]=new c("images/vault_4.0/secureNoteIcons/Bank_Account.png","noteBank");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.CREDIT]=
new c("images/vault_4.0/secureNoteIcons/Generic_Credit_Card.png","noteCredit");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.DATABASE]=new c("images/vault_4.0/secureNoteIcons/Database.png","noteDatabase");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.DRIVERS_LICENSE]=new c("images/vault_4.0/secureNoteIcons/Drivers_License.png","noteDriversLicense");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.EMAIL]=new c("images/vault_4.0/secureNoteIcons/Email.png","noteEmail");
NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.GENERIC]=new c("images/vault_4.0/secureNoteIcons/Generic_Note.png","noteGeneric");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.HEALTH_INSURANCE]=new c("images/vault_4.0/secureNoteIcons/Health_Insurance.png","noteHealthInsurance");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.IM]=new c("images/vault_4.0/secureNoteIcons/Instant_Messenger.png","noteIM");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.INSURANCE]=
new c("images/vault_4.0/secureNoteIcons/Insurance.png","noteInsurance");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.MASTERCARD]=new c("images/vault_4.0/secureNoteIcons/Mastercard.png","noteMastercard");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.MEMBERSHIP]=new c("images/vault_4.0/secureNoteIcons/Membership.png","noteMembership");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.PASSPORT]=new c("images/vault_4.0/secureNoteIcons/Passport.png","notePassport");
NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.SERVER]=new c("images/vault_4.0/secureNoteIcons/Server.png","noteServer");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.SSN]=new c("images/vault_4.0/secureNoteIcons/Social_Security.png","noteSSN");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.SOFTWARE_LICENSE]=new c("images/vault_4.0/secureNoteIcons/Software_License.png","noteSoftwareLicense");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.SSH_KEY]=new c("images/vault_4.0/secureNoteIcons/SSH_Key.png",
"noteSSHKey");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.VISA]=new c("images/vault_4.0/secureNoteIcons/Visa.png","noteVisa");NoteDisplay.prototype.NOTE_TYPES[Note.prototype.NOTE_TYPES.WIFI]=new c("images/vault_4.0/secureNoteIcons/WiFi.png","noteWiFi");NoteDisplay.prototype.CUSTOM_NOTE_TYPE=new c("images/vault_4.0/secureNoteIcons/Secure_Note.png","noteCustom");NoteDisplay.prototype.getLaunchElementAction=function(){return Constants.ACTION_EDIT};NoteDisplay.prototype.build=function(c){var b=
VaultItemDisplay.prototype.build.apply(this,arguments);e.addClass(b,"note");return b};NoteDisplay.prototype.getIconElement=function(){var c=this._model.isCustom()?this.CUSTOM_NOTE_TYPE:this.NOTE_TYPES[this._model.getNoteType()],b=e.createElement("div","noteFormFillIcon "+c.css);b.appendChild(e.createElement("img",{src:c.path,"class":"bigIcon"}));return b};NoteDisplay.prototype.getContextMenuItems=function(c){var b=AccountBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);c||(b.push(new e.ContextMenuItem(Constants.ACTION_COPY_NOTE,
{divider:!0})),this._model.hasPassword()&&b.push(new e.ContextMenuItem(Constants.ACTION_COPY_PASSWORD)),this._model.hasUsername()&&b.push(new e.ContextMenuItem(Constants.ACTION_COPY_USERNAME)),this._model.hasPrivateKey()&&b.push(new e.ContextMenuItem(Constants.ACTION_COPY_KEY)));return b}})();(function(){AttachmentDisplay.prototype.getContextMenuItems=function(){var c=VaultItemBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);c.push(new e.ContextMenuItem(Constants.ACTION_OPEN));c.push(new e.ContextMenuItem(Constants.ACTION_SAVE));
c.push(new e.ContextMenuItem(Constants.ACTION_DELETE,{divider:!0}));return c};AttachmentDisplay.prototype.getAttachmentNameFirst=function(){var c=this.getDisplayName(),e=c.lastIndexOf(".")-2;return 0<e?c.substring(0,e):c};AttachmentDisplay.prototype.getAttachmentNameSecond=function(){var c=this.getDisplayName(),e=c.lastIndexOf(".")-2;return 0<e?c.substring(e):c};AttachmentDisplay.prototype.build=function(c){c=e.createElement("div",{"class":"attachment",vaultaction:Constants.ACTION_OPEN,title:Strings.Vault.OPEN+
" "+this.getDisplayName()});var f=e.createElement("div","textOverflowContainer");f.appendChild(this.createTextElement("span",this.getAttachmentNameFirst,"attachmentName"));c.appendChild(f);c.appendChild(this.createTextElement("span",this.getAttachmentNameSecond,"attachmentName textTail"));c.appendChild(e.createElement("div",{vaultaction:Constants.ACTION_DELETE,title:Strings.Vault.DELETE,"class":"deleteAttachment"}));return c};AttachmentDisplay.prototype.postBuild=function(c,f){VaultItemBaseDisplay.prototype.postBuild.apply(this,
arguments);var b=this._$_element;setTimeout(function(){e.setupMiddleEllipsis(b)},0)}})();(function(){FormFillDisplay.prototype.getContextMenuItems=function(c){var f=VaultItemDisplay.prototype.getContextMenuItems.apply(this,arguments);c||f.push(new e.ContextMenuItem(Constants.ACTION_EDIT));f.push(new e.ContextMenuItem(Constants.ACTION_DELETE));return f};FormFillDisplay.prototype.getIconElement=function(){var c=m.decryptMobile(this._model._data.ccnum,!0,this._model.getKey()),f=LPCC.getCCIcon4_0(c),
c=LPCC.getCCClass4_0(c),c=e.createElement("div",c+" noteFormFillIcon"),b=e.createElement("div");this.includeCreditInfo()&&(b.appendChild(this.createTextElement("p",this.getCardNumberDisplay,{"class":"ccNum"})),b.appendChild(this.createTextElement("p",this.getCardExpirationDisplay,{"class":"ccExp"})));b.appendChild(e.createElement("img",{src:"images/vault_4.0/"+f,"class":"bigIcon"}));c.appendChild(b);return c};FormFillDisplay.prototype.includeCreditInfo=function(){return this._model.isCreditCard()&&
!this._model.passwordProtected()};FormFillDisplay.prototype.getCardExpirationDisplay=function(){var c=m.decryptMobile(this._model._data.ccexp,!0,this._model.getKey());return c&&(c=c.split("-"),2===c.length)?c[1]+"/"+c[0].slice(-2):"--/--"};FormFillDisplay.prototype.getCardNumberDisplay=function(){return LPCC.getFormattedNumber(m.decryptMobile(this._model._data.ccnum,!0,this._model.getKey()))};FormFillDisplay.prototype.getCardNameDisplay=function(){return m.decryptMobile(this._model._data.ccname,!0,
this._model.getKey())};FormFillDisplay.prototype.build=function(c){var f=VaultItemDisplay.prototype.build.apply(this,arguments);e.addClass(f,"formFill");this.includeCreditInfo()&&e.addClass(f,"ccInfo");return f};FormFillDisplay.prototype.createSecondaryNameTextElement=function(){return this.includeCreditInfo()?this.createTextElement("p",this.getCardNameDisplay,"small infoLabel"):VaultItemDisplay.prototype.createSecondaryNameTextElement.apply(this,arguments)};FormFillDisplay.prototype.getLaunchElementAction=
function(){return Constants.ACTION_EDIT};FormFillDisplay.prototype.isDraggable=function(){return!1};FormFillDisplay.prototype.getItemButtonActions=function(){return[Constants.ACTION_EDIT,Constants.ACTION_DELETE]}})();(function(){IdentityDisplay.prototype.getContextMenuItems=function(c){var f=VaultItemBaseDisplay.prototype.getContextMenuItems.apply(this,arguments);this._model._enabled||f.push(new e.ContextMenuItem(Constants.ACTION_ENABLE));f.push(new e.ContextMenuItem(Constants.ACTION_EDIT));f.push(new e.ContextMenuItem(Constants.ACTION_DELETE));
return f};IdentityDisplay.prototype.build=function(){var c=VaultItemBaseDisplay.prototype.build.apply(this,arguments);e.addClass(c,"identity");return c};IdentityDisplay.prototype.getIconElement=function(){return e.createElement("img",{src:"images/vault_4.0/Identity_Avatar.png","class":"bigIcon"})};IdentityDisplay.prototype.getLaunchElementAction=function(){return Constants.ACTION_ENABLE};IdentityDisplay.prototype.getItemButtonActions=function(){return[Constants.ACTION_EDIT,Constants.ACTION_DELETE]};
IdentityDisplay.prototype.updateEnabledClass=function(){this._model._enabled?this._$_element.addClass("enabled"):this._$_element.removeClass("enabled")};IdentityDisplay.prototype.postBuild=function(){VaultItemBaseDisplay.prototype.postBuild.apply(this,arguments);this.updateEnabledClass()};IdentityDisplay.prototype.updateView=function(){VaultItemBaseDisplay.prototype.updateView.apply(this,arguments);this.updateEnabledClass()};AllIdentityDisplay.prototype.getContextMenuItems=function(c){var f=VaultItemBaseDisplay.prototype.getContextMenuItems.apply(this,
arguments);this._model._enabled||f.push(new e.ContextMenuItem(Constants.ACTION_ENABLE));return f};AllIdentityDisplay.prototype.build=function(){var c=VaultItemBaseDisplay.prototype.build.apply(this,arguments);e.addClass(c,"allIdentity");return c};AllIdentityDisplay.prototype.getItemButtonActions=function(){return[]};AllIdentityDisplay.prototype.handleToggleSelectedEvent=function(){}})()})($,document,LPTools,LPProxy);
